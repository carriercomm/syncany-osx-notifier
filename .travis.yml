language: objective-c

env:
  global:

  # Encrypted env variable SYNCANY_API_KEY for upload
  - secure: "F5u35u2CyYTRDSIbp1kZpTG7n4YTz+osg13fQ3DGYvqRPx2olyOFNV0dEPO5Y6xby6ki6re8sCl84KBnlqNxcRMhINgybhnDKgd149y2ST9n1RF5mvEvqMffYbAMOHoizv0y23wm50tWzZC6q20cb9xaUoiFQwPu/ZQDCSLL7g4="

notifications:
  email: false
  irc: chat.freenode.net#syncany
  
before_install:
- brew update
- brew outdated xctool || brew upgrade xctool
- brew install jq
- chmod a+x ./.travis.sh
- chmod a+x ./.upload.sh

script:
- xctool -configuration release -project Syncany.xcodeproj -scheme Syncany build
- mv $HOME/Library/Developer/Xcode/DerivedData/Syncany-*/Build/Products/Release/Syncany.app .
- zip -r -X syncany-osx-notifier.app.zip Syncany.app

after_success:
- ./.travis.sh
- ./.upload.sh
